// Replace these URLs with your actual Google Sheets CSV publish links
const resultsCsvUrl = "https://docs.google.com/spreadsheets/d/e/2PACX-.../pub?output=csv";
const studentsCsvUrl = "https://docs.google.com/spreadsheets/d/e/2PACX-.../pub?output=csv";

// Load CSV data for results from Google Sheets
Papa.parse(resultsCsvUrl, {
  download: true,
  header: true,
  complete: function(results) {
    const tbody = document.querySelector("#resultsTable tbody");
    tbody.innerHTML = "";
    results.data.forEach(row => {
      if(row['examno'] && row['roll'] && row['name']){
        const tr = document.createElement("tr");
        tr.innerHTML = `
          <td>${row.examno}</td>
          <td>${row.roll}</td>
          <td>${row.name}</td>
          <td>${row.class}</td>
          <td>${row.total_marks}</td>
          <td>${row.obtain_marks}</td>
          <td>${row.merit}</td>
        `;
        tbody.appendChild(tr);
      }
    });
    document.getElementById("loadingResults").style.display = "none";
    document.getElementById("resultsTable").style.display = "table";
  }
});

// Load CSV data for students from Google Sheets
Papa.parse(studentsCsvUrl, {
  download: true,
  header: true,
  complete: function(results) {
    const tbody = document.querySelector("#studentTable tbody");
    tbody.innerHTML = "";
    results.data.forEach(row => {
      if(row['roll'] && row['name']){
        const tr = document.createElement("tr");
        tr.innerHTML = `
          <td>${row.roll}</td>
          <td>${row.name}</td>
          <td>${row.class}</td>
          <td><a href="tel:${row.phone}">${row.phone}</a></td>
          <td>${row.address}</td>
        `;
        tbody.appendChild(tr);
      }
    });
    document.getElementById("loadingStudents").style.display = "none";
    document.getElementById("studentTable").style.display = "table";
  }
});
